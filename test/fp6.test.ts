import {
    Fp, Fp2, Fp6
  } from '../math';

describe('fp6', () => {
    it('mult', () => {
        let a = new Fp6(
            new Fp2(
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed57cn),
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed563n)
            ),
            new Fp2(
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed562n),
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed561n)
            ),
            new Fp2(
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed560n),
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed567n)
            )
        );
        let aa: Fp6 = a.multiply(a);

        

        expect(aa.c0.c0.toString()).toBe("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153fffe877e1715b7a71e48");
        expect(aa.c0.c1.toString()).toBe("00000000000000000000000000000000000000000000000000000000000000000000000000000001cbc15d947e23b0f6");
        expect(aa.c1.c0.toString()).toBe("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffff20be8b9310b1e3e4");
        expect(aa.c1.c1.toString()).toBe("00000000000000000000000000000000000000000000000000000000000000000000000000000001cbc15d9366060593");
        expect(aa.c2.c0.toString()).toBe("0000000000000000000000000000000000000000000000000000000000000000000000000000000000000014ca33ac19");
        expect(aa.c2.c1.toString()).toBe("00000000000000000000000000000000000000000000000000000000000000000000000000000001cbc15d9b0ed5b24c");

        expect(aa.equals(a.square())).toBe(true);
    })

    it('fp2inv', () => {

        let fp2 = new Fp2(
            new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed57cn),
            new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed563n)
        )

        let inv = fp2.invert()

        expect(inv.c0.toString()).toBe("0990a4c1e582bfd21af11d192c680b77902a6407ab042c9fcea574e03f870eb764b31d443aff543b19b9141f1c418f11");
        expect(inv.c1.toString()).toBe("151dddade92ab5209a591e81abaa5e02f42f44ea2371aa002b719fd135df3818efdef2a042192ba083a76413517bd36e");
       
    })



    it('multby1', () => {

   
        let x = new Fp2(
            new Fp(0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153fffe877e1715b7a71e48n),
            new Fp(0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffff20be8b9310b1e3e4n)
        )
      
        let a = new Fp6(
            new Fp2(
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed57cn),
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed563n)
            ),
            new Fp2(
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed562n),
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed561n)
            ),
            new Fp2(
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed560n),
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed567n)
            )
        );

        let sut = a.multiplyBy1(x)

        expect(sut.c0.c0.toString()).toBe("000000000000000000000000000000000000000000000000000000000000000000000000a7b041e8a6056338d26c8166");
        expect(sut.c0.c1.toString()).toBe("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffd61f37c316c36813d51da3b27");
        expect(sut.c1.c0.toString()).toBe("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffe5d7bdee8fb0226e76b3cbdac");
        expect(sut.c1.c1.toString()).toBe("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffdb5cb9d18470ef6c1349725fe");
        expect(sut.c2.c0.toString()).toBe("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffe5d7bdf06e998e5d8e59f722c");
        expect(sut.c2.c1.toString()).toBe("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffdb5cb9d2a3c9c9ba6132e6efa");

        expect(a.equals(a.frobeniusMap(6))).toBe(true)
    })


    it('multby01', () => {

   
        let x = new Fp2(
            new Fp(0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153fffe877e1715b7a71e48n),
            new Fp(0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffff20be8b9310b1e3e4n)
        )

        let y = new Fp2(
            new Fp(0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffff20be8b9310b1e3e4n),
            new Fp(0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153fffe877e1715b7a71e48n)
        )
      
        let a = new Fp6(
            new Fp2(
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed57cn),
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed563n)
            ),
            new Fp2(
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed562n),
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed561n)
            ),
            new Fp2(
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed560n),
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed567n)
            )
        );

        let sut = a.multiplyBy01(x, y);

        expect(sut.c0.c0.toString()).toBe("000000000000000000000000000000000000000000000000000000000000000000000000fb8862bff052039f2fa36167");
        expect(sut.c0.c1.toString()).toBe("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffd0e1b5b406416505857025202");
        expect(sut.c1.c0.toString()).toBe("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153fff0c2b3a16d0b244011");
        expect(sut.c1.c1.toString()).toBe("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffcba433a33d261322995b89e11");
        expect(sut.c2.c0.toString()).toBe("0000000000000000000000000000000000000000000000000000000000000000000000000000000430c32f0af4dd6e46");
        expect(sut.c2.c1.toString()).toBe("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffcba433a4e2975362af9dab0e9");

    })

    it('fp6inv', () => {
        console.log("ðŸ”® STELLA E BAST");
        let a = new Fp6(
            new Fp2(
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed57cn),
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed563n)
            ),
            new Fp2(
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed562n),
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed561n)
            ),
            new Fp2(
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed560n),
                new Fp(0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c0ed567n)
            )
        );
        let aInv: Fp6 = a.invert()

        expect(aInv.c0.c0.toString()).toBe("0f5d3888ce8fb7e81051c8ab459ec57c5cac1cc5bad8d497f5d941f454303adb51e1f13856f01eb3b6e96a349bfd506c");
        expect(aInv.c0.c1.toString()).toBe("00b5066943316367b6f802b3e2feb164112cf652c56a8fe4395f22843335c3f6db7d125937cfa97b25f59ab0a0ccae5d");
        expect(aInv.c1.c0.toString()).toBe("1308087806edee690d656f71d22ae367dfc4963d04e46a2853d2e3d80c1b7494544e1cba6032f0db129086d6da4a1d61");
        expect(aInv.c1.c1.toString()).toBe("18b68ea30cef69b18b39c24d25fff7c55b0ac9f2255e96f66d8aac1249925ad6c5f810e86dacdf69633e1b646ce82c64");
        expect(aInv.c2.c0.toString()).toBe("07b1fa73b4b5c51f32ea6b76a0fa01e75c758e06983c5f6813890ef66fa9285f69c75be4c28fb6fb742f8f4cb2e91545");
        expect(aInv.c2.c1.toString()).toBe("10fc74a9af1ceb669cf38cd6277e1cd4f7f4c10b46219aed14de3948b4b64a318f174c3b5e403449dcbc2aab5f712c57");

        expect((aInv.multiply(a)).equals(Fp6.ONE)).toBe(true);

    })
});